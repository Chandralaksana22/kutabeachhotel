import e from"node:process";globalThis._importMeta_=globalThis._importMeta_||{url:"file:///_entry.js",env:e.env};import{getRequestDependencies as t,getPreloadLinks as n,getPrefetchLinks as r,createRenderer as o}from"vue-bundle-renderer/runtime";import{c as s,e as a,p as i,g as l,f as p,h as d,u as c,i as u,j as f,b as h}from"../_/nitro.mjs";import{stringify as m,uneval as g}from"devalue";import{renderToString as y}from"vue/server-renderer";import{propsToString as x,renderSSRHead as b}from"@unhead/ssr";import{createServerHead as v,CapoPlugin as _}from"unhead";import{version as w,unref as C}from"vue";import{defineHeadPlugin as T}from"@unhead/shared";import"node:http";import"node:https";import"consola/core";import"node:fs";import"node:url";import"ipx";import"node:path";const j="3"===w[0];function resolveUnrefHeadInput(e){if(e instanceof Promise||e instanceof Date||e instanceof RegExp)return e;const t="function"==typeof(n=e)?n():C(n);var n;if(!e||!t)return t;if(Array.isArray(t))return t.map((e=>resolveUnrefHeadInput(e)));if("object"==typeof t){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&("titleTemplate"===n||"o"===n[0]&&"n"===n[1]?e[n]=C(t[n]):e[n]=resolveUnrefHeadInput(t[n]));return e}return t}const S=T({hooks:{"entries:resolve":e=>{for(const t of e.entries)t.resolvedInput=resolveUnrefHeadInput(t.input)}}});function createServerHead(e={}){const t=v(e);return t.use(S),t.install=function(e){return{install(t){j&&(t.config.globalProperties.$unhead=e,t.config.globalProperties.$head=e,t.provide("usehead",e))}}.install}(t),t}const A=[_({track:!0})],z={omitLineBreaks:!1},R={meta:[{name:"viewport",content:"width=device-width, initial-scale=1"},{charset:"utf-8"},{name:"msapplication-TileColor",content:"#ffffff"},{name:"msapplication-TileImage",content:"/ms-icon-144x144.png"},{name:"theme-color",content:"#ffffff"}],link:[{rel:"apple-touch-icon",sizes:"57x57",href:"/apple-icon-57x57.png"},{rel:"apple-touch-icon",sizes:"60x60",href:"/apple-icon-60x60.png"},{rel:"apple-touch-icon",sizes:"72x72",href:"/apple-icon-72x72.png"},{rel:"apple-touch-icon",sizes:"76x76",href:"/apple-icon-76x76.png"},{rel:"apple-touch-icon",sizes:"114x114",href:"/apple-icon-114x114.png"},{rel:"apple-touch-icon",sizes:"120x120",href:"/apple-icon-120x120.png"},{rel:"apple-touch-icon",sizes:"144x144",href:"/apple-icon-144x144.png"},{rel:"apple-touch-icon",sizes:"152x152",href:"/apple-icon-152x152.png"},{rel:"apple-touch-icon",sizes:"180x180",href:"/apple-icon-180x180.png"},{rel:"icon",type:"image/png",sizes:"192x192",href:"/android-icon-192x192.png"},{rel:"icon",type:"image/png",sizes:"32x32",href:"/favicon-32x32.png"},{rel:"icon",type:"image/png",sizes:"96x96",href:"/favicon-96x96.png"},{rel:"icon",type:"image/png",sizes:"16x16",href:"/favicon-16x16.png"},{rel:"manifest",href:"/manifest.json"}],style:[],script:[],noscript:[]},k={id:"teleports"};globalThis.__buildAssetsURL=a,globalThis.__publicAssetsURL=i;const getClientManifest=()=>import("../build/client.manifest.mjs").then((e=>e.default||e)).then((e=>"function"==typeof e?e():e)),P=lazyCachedFunction((()=>import("../build/styles.mjs").then((e=>e.default||e)))),H=lazyCachedFunction((async()=>{const e=await getClientManifest();if(!e)throw new Error("client.manifest is not available");const t=await import("../build/server.mjs").then((e=>e.default||e));if(!t)throw new Error("Server bundle is not available");return o(t,{manifest:e,renderToString:async function(e,t){const n=await y(e,t);return O+n+I},buildAssetsURL:a})})),U=lazyCachedFunction((async()=>{const e=await getClientManifest(),t=await import("../virtual/_virtual_spa-template.mjs").then((e=>e.template)).catch((()=>"")).then((e=>O+e+I)),n=o((()=>()=>{}),{manifest:e,renderToString:()=>t,buildAssetsURL:a}),r=await n.renderToString({});return{rendererContext:n.rendererContext,renderToString:e=>{const t=c(e.event);return e.modules=e.modules||new Set,e.payload.serverRendered=!1,e.config={public:t.public,app:t.app},Promise.resolve(r)}}})),$=!!k.id,L=$?`<div${x(k)}>`:"",N=$?"</div>":"",O=`<div${x({id:"__nuxt"})}>`,I="</div>",M=/\/_payload.json(\?.*)?$/,F=s((async e=>{const o=h(),s=e.path.startsWith("/__nuxt_error")?l(e):null;if(s&&s.statusCode&&(s.statusCode=Number.parseInt(s.statusCode)),s&&!("__unenv__"in e.node.req))throw p({statusCode:404,statusMessage:"Page Not Found: /__nuxt_error"});const a=false,i=void 0;let g=s?.url||e.path;const y=M.test(g)&&!0;y&&(g=g.substring(0,g.lastIndexOf("/"))||"/",e._path=g,e.node.req.url=g);const x=d(e),v=createServerHead({plugins:A}),_={mode:"server"};v.push(R,_);const w={url:g,event:e,runtimeConfig:c(e),noSSR:e.context.nuxt?.noSSR||!1===x.ssr&&!0||!1,head:v,error:!!s,nuxt:void 0,payload:s?{error:s}:{},_payloadReducers:Object.create(null),modules:new Set,islandContext:i},C=w.noSSR?await U():await H();for(const e of await getClientManifest().then((e=>Object.values(e).filter((e=>e._globalCSS)).map((e=>e.src)))))w.modules.add(e);const T=await C.renderToString(w).catch((async e=>{if(w._renderResponse&&"skipping render"===e.message)return{};const t=!s&&w.payload?.error||e;throw await(w.nuxt?.hooks.callHook("app:error",t)),t}));if(await(w.nuxt?.hooks.callHook("app:rendered",{ssrContext:w,renderResult:T})),w._renderResponse)return w._renderResponse;if(w.payload?.error&&!s)throw w.payload.error;if(y){const e=function(e){return{body:m(splitPayload(e).payload,e._payloadReducers),statusCode:u(e.event),statusMessage:f(e.event),headers:{"content-type":"application/json;charset=utf-8","x-powered-by":"Nuxt"}}}(w);return e}const j=await async function(e){const t=await P(),n=new Set;for(const r of e)if(r in t&&t[r])for(const e of await t[r]())n.add(e);return Array.from(n).map((e=>({innerHTML:e})))}(w.modules??[]),S=x.experimentalNoScripts,{styles:O,scripts:I}=t(w,C.rendererContext);j.length&&v.push({style:j});{const e=[];for(const t of Object.values(O))e.push({rel:"stylesheet",href:C.rendererContext.buildAssetsURL(t.file),crossorigin:""});e.length&&v.push({link:e},_)}S||(v.push({link:n(w,C.rendererContext)},_),v.push({link:r(w,C.rendererContext)},_),v.push({script:renderPayloadJsonScript({ssrContext:w,data:w.payload})},{..._,tagPosition:"bodyClose",tagPriority:"high"})),x.experimentalNoScripts||v.push({script:Object.values(I).map((e=>({type:e.module?"module":null,src:C.rendererContext.buildAssetsURL(e.file),defer:!e.module||null,tagPosition:"head",crossorigin:""})))},_);const{headTags:F,bodyTags:E,bodyTagsOpen:D,htmlAttrs:X,bodyAttrs:q}=await b(v,z),B={island:a,htmlAttrs:X?[X]:[],head:normalizeChunks([F]),bodyAttrs:q?[q]:[],bodyPrepend:normalizeChunks([D,w.teleports?.body]),body:[T.html,L+($?joinTags([w.teleports?.[`#${k.id}`]]):"")+N],bodyAppend:[E]};await o.hooks.callHook("render:html",B,{event:e});var J;return{body:(J=B,`<!DOCTYPE html><html${joinAttrs(J.htmlAttrs)}><head>${joinTags(J.head)}</head><body${joinAttrs(J.bodyAttrs)}>${joinTags(J.bodyPrepend)}${joinTags(J.body)}${joinTags(J.bodyAppend)}</body></html>`),statusCode:u(e),statusMessage:f(e),headers:{"content-type":"text/html;charset=utf-8","x-powered-by":"Nuxt"}}}));function lazyCachedFunction(e){let t=null;return()=>(null===t&&(t=e().catch((e=>{throw t=null,e}))),t)}function normalizeChunks(e){return e.filter(Boolean).map((e=>e.trim()))}function joinTags(e){return e.join("")}function joinAttrs(e){return 0===e.length?"":" "+e.join(" ")}function renderPayloadJsonScript(e){const t={type:"application/json",innerHTML:e.data?m(e.data,e.ssrContext._payloadReducers):"","data-nuxt-data":"nuxt-app","data-ssr":!e.ssrContext.noSSR,id:"__NUXT_DATA__"};e.src&&(t["data-src"]=e.src);return[t,{innerHTML:`window.__NUXT__={};window.__NUXT__.config=${g(e.ssrContext.config)}`}]}function splitPayload(e){const{data:t,prerenderedAt:n,...r}=e.payload;return{initial:{...r,prerenderedAt:n},payload:{data:t,prerenderedAt:n}}}export{F as default};
//# sourceMappingURL=renderer.mjs.map
